<HTML>
<HEAD>
<TITLE>purge-binaries</TITLE>
<LINK REV="made" HREF="mailto:theall@tifaware.com">
</HEAD>

<!--#include virtual="/header.html"-->
<!--#if expr="$weblint" -->
<BODY BGCOLOR="#FFFFFF">
<!--#endif -->


<H4 ALIGN="center">
   <A HREF="/">TifaWARE</A> |
   <A HREF="../">Perl Programs</A> |
   purge-binaries
</H4>
                                                                                
                                                                                
<HR>
<H2>purge-binaries</H2>

<H3>Introduction</H3>

<P>News administrators seeking to keep a handle on the size of their
newsfeeds may opt, as I have, not to carry binaries.  While it is fairly
simple to drop newsgroups with <CODE>binaries</CODE>,
<CODE>pictures</CODE>, and <CODE>sound</CODE> in their names, you still
need to deal with binaries posted in newsgroups intended solely for
discussions.</P>

<P>To handle this for news servers running <A
HREF="http://www.isc.org/products/INN/">innd</A>, I wrote the perl
script <B>purge-binaries</B>.  <B>purge-binaries</B> scans news
postings, purging those it determines to be binary files.  It is
designed to work as a channel with inn, although it should be possible
to feed it output from <CODE>ls -l</CODE> too.</P>

<P>To use it, you will need Perl 4.0 or better as well as the
<CODE>ctime.pl</CODE> routine that emulates <CODE>ctime(3C)</CODE>.</P>

<P>As an alternative, you may want to investigate <A
HREF="http://www.exit109.com/~jeremy/news/cleanfeed/">cleanfeed</A>.
Provided you're running innd with perl filtering enabled, cleanfeed not
only filters out binaries but also traps a whole slew of other garbage
that would otherwise fill up your newsspool.</P>


<H3>Installation</H3>

<OL>
   <LI>Retrieve the script <A HREF="/code/purge-binaries/purge-binaries">purge-binaries</A>
      and save it locally.  You may also wish to verify its
      <A HREF="/code/purge-binaries/purge-binaries.md5">MD5 checksum</A> or, better, its
      <A HREF="/code/purge-binaries/purge-binaries.asc">GPG signature</A> against
      <A HREF="/~theall/gpg.html">my current GPG key</A>.</LI>
   <LI>Verify ownership and permissions on the script.</LI>
   <LI>Edit the script and adjust the location of the perl in the 
      first line, <CODE>$logfile</CODE>, <CODE>$encodedpct</CODE>, 
      <CODE>$minsize</CODE>, and/or <CODE>$maxlines</CODE> to suit 
      your tastes.</LI>
</OL>


<H3>Use</H3>

<P>By design, <B>purge-binaries</B> operates as a channel with inn,
checking each article as it arrives and deleting binaries.  To use, add
an entry like the following to your newsfeeds file:</P>

<BLOCKQUOTE>
purge-binaries:*:Tc,WbO:/usr/local/news/bin/purge-binaries
</BLOCKQUOTE>

<P>which will process articles in every newsgroup.  If you'd prefer, you
can modify this entry to restrict attention to certain hierarchies
and/or newsgroups.  Refer to <CODE>newsfeeds(5)</CODE> for more specific
information.</P>

<P>Note that this channel is fed overview data so crossposted articles
will be handled properly.</P>

<P>You may want to adjust some of the parameters in the script itself to
improve performance or whatnot.  One word of warning though - lowering
the percentage of encoding will increase the risk of falsely identifying
a post as a binary.</P>

<P>Also of interest may be Brian Edmonds' <A
HREF="http://www.cs.ubc.ca/spider/edmonds/usenet/binsummary.pl">binsummary
script</A>, which summarizes the output generated by
<B>purge-binaries</B>.  It shows hidden binary groups and how prevalent
binary postings are in various groups.</P>


<H3>License</H3>

<P>You may freely use and redistribute this.  I can not offer any
support but am interested in your comments, suggestions, and problem
reports.  Note, though, that I no longer administer a news server so I'm
not likely to be able to troubleshoot problems you might have with this
script.</P>


<H3>History</H3>

<CENTER>
<TABLE CELLPADDING="5" CELLSPACING="0" WIDTH="95%" BORDER="1">
   <TR>
      <TH ALIGN="left">Date </TH>
      <TH ALIGN="left">Version </TH>
      <TH ALIGN="left">Verification </TH>
      <TH ALIGN="left">Notes<BR></TH>
   </TR>
   <TR>
      <TH ALIGN="left" VALIGN="top">07-Feb-1996 </TH>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0f">1.0f</A> </TD>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0f.md5">MD5</A> / 
         <A HREF="/code/purge-binaries/purge-binaries-1.0f.asc">GPG</A> </TD>
      <TD ALIGN="left" VALIGN="top">Tweaked <CODE>isbinary()</CODE> to 
         identify other types of binaries such as audio and video 
         files.<BR></TD>
   </TR>
   <TR>
      <TH ALIGN="left" VALIGN="top">25-Jan-1996 </TH>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0e">1.0e</A> </TD>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0e.md5">MD5</A> / 
         <A HREF="/code/purge-binaries/purge-binaries-1.0e.asc">GPG</A> </TD>
      <TD ALIGN="left" VALIGN="top">Tweaked <CODE>isbinary()</CODE> so that 
         identifying MIME attachments using a header line is 
         case-insensitive.<BR></TD>
   </TR>
   <TR>
      <TH ALIGN="left" VALIGN="top">12-Jun-1995 </TH>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0d">1.0d</A> </TD>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0d.md5">MD5</A> / 
         <A HREF="/code/purge-binaries/purge-binaries-1.0d.asc">GPG</A> </TD>
      <TD ALIGN="left" VALIGN="top">Tweaked <CODE>isbinary()</CODE> to better 
         handle MIME-encoded files again.<BR></TD>
   </TR>
   <TR>
      <TH ALIGN="left" VALIGN="top">15-May-1995 </TH>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0c">1.0c</A> </TD>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0c.md5">MD5</A> / 
         <A HREF="/code/purge-binaries/purge-binaries-1.0c.asc">GPG</A> </TD>
      <TD ALIGN="left" VALIGN="top">Now scans messages with <I>FAQ</I> or 
         <I>Frequently Asked Questions</I> in the subject line.<BR></TD>
   </TR>
   <TR>
      <TH ALIGN="left" VALIGN="top">10-May-1995 </TH>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0b">1.0b</A> </TD>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0b.md5">MD5</A> / 
         <A HREF="/code/purge-binaries/purge-binaries-1.0b.asc">GPG</A> </TD>
      <TD ALIGN="left" VALIGN="top">Tweaked <CODE>isbinary()</CODE> to 
         better handle MIME-encoded files.<BR></TD>
   </TR>
   <TR>
      <TH ALIGN="left" VALIGN="top">02-May-1995 </TH>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0a">1.0a</A> </TD>
      <TD ALIGN="left" VALIGN="top"><A HREF="/code/purge-binaries/purge-binaries-1.0a.md5">MD5</A> / 
         <A HREF="/code/purge-binaries/purge-binaries-1.0a.asc">GPG</A> </TD>
      <TD ALIGN="left" VALIGN="top">Initial version.<BR></TD>
   </TR>
</TABLE>
</CENTER>


<HR>
<H4 ALIGN="center">
   <A HREF="/">TifaWARE</A> |
   <A HREF="../">Perl Programs</A> |
   purge-binaries
</H4>
                                                                                
                                                                                
<!--#include virtual="/footer.html" -->
<!--#if expr="$weblint" -->
</BODY>
<!--#endif -->
</HTML>
